<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>차단기 액션 페이지</title>
    <!-- Bootstrap CDN -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
    <!-- jQuery CDN -->
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
</head>
<body class="bg-light">
    <div class="container d-flex flex-column justify-content-center align-items-center vh-100">
        <h2 class="mb-4 text-center">차단기 동작</h2>

        <div class="d-grid gap-3 col-10 mx-auto">
            <button type="button" id="openBtn" class="btn btn-success btn-lg">Open</button>
            <button type="button" id="closeBtn" class="btn btn-danger btn-lg">Close</button>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
</body>
<script>
    // open
    $("#openBtn").on("click", function() {
        fn_reqGateCtrl("open");

    });

    // clsoe
    $("#closeBtn").on("click", function () {
        fn_reqGateCtrl("close");
    });

// 게이트 액션에 따른 요청 함수
function fn_reqGateCtrl(action) {
    $.ajax({
        url: '/gateCtrl',
        type: 'POST',
        data: JSON.stringify({ action: action }),
        contentType: 'application/json',
        success: function(response) {
            // 로그 insert 결과 성공 : true, 실패 : false
            result = response.result;
            if(result) { // 입출차 로그가 정상적으로 잘 쌓였다면
                var msg = "차단기가 ";
                if(action == "open") {
                    msg += "열렸습니다.";
                } else {
                    msg += "닫혔습니다.";
                }
                alert(msg);
            } else { // insert시 실패하였다면
                alert("오류가 발생하였습니다.");
            }

        }
    });
}
</script>
</html>